name: Run Python Script

on:
  schedule:
    - cron: "*/15 * * * *"  # should be every 15mins for now, just want to test and see if it works

jobs:
  run-script:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: "3.9"

      - name: Install Dependencies
        run: |
          python -m pip install --upgrade pip
          pip install selenium webdriver-manager

      - name: Run Python Script
        id: download_csv
        env:
          DOWNLOAD_DIR: ./output
        run: |
          rm -f ./output/*.csv
          python main.py
          echo "CSV file path: ${{ steps.download_csv.outputs.csv_file }}"

      - name: Commit and Push Changes
        run: |
          csv_file_path="${{ steps.download_csv.outputs.csv_file }}"
          echo "Path of the downloaded file: $csv_file_path"
          
          git config --global user.name "GitHub Actions"
          git config --global user.email "actions@github.com"

          git add "$csv_file_path" # PLEASE WORK PLEASE PLEASE PLEASE 

          git commit -m "automated CSV file downloaded???"
          git push
